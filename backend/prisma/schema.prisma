generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Mock {
  id            Int          @id @default(autoincrement())
  name          String
  endpoint      String
  method        String       @db.VarChar(10)
  status_code   Int
  headers       String?
  body          String?
  body_patterns String?
  matcher_type  MatcherType?
  created_by_id Int
  author        User         @relation(fields: [created_by_id], references: [id])
  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt
  Log           Log[]
}

enum MatcherType {
  KEY_TO_KEY
  KEY_TO_VALUE
}

model Log {
  id            Int      @id @default(autoincrement())
  mock          Mock     @relation(fields: [mock_id], references: [id])
  mock_id       Int
  method        String   @db.VarChar(10)
  status_code   Int
  request_body  String?
  response_body String?
  request_time  DateTime
  response_time DateTime
  created_at    DateTime @default(now())
}

model User {
  id            Int     @id @default(autoincrement())
  username      String?
  login         String  @unique
  password_hash String  @db.VarChar(255)
  Mock          Mock[]
}
